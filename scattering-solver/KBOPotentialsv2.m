function U=KBOPotentialsv2(r,sel)
% Energies in cm^-1, lengths in angstroms

if sel==0,
    %% Singlet potential
    Rinner=2.870;
    Router=12;

    %% Inner region
    A=-0.262878738e4;
    B=0.8129033720e9;
    Ns=12;

    %% Intermediate region
    b=-0.4;
    Rm=3.92436437;
    a(1)=-4450.899108;
    a(2)=0.027435192082021;
    a(3)=0.13671215240591e5;
    a(4)=0.10750901039993e5;
    a(5)=-0.20933147904789e4;
    a(6)=-0.19385880603136e5;
    a(7)=-0.49208904259548e5;
    a(8)=0.11026640034823e6;
    a(9)=0.72867340031285e6;
    a(10)=-0.29310679230619e7;
    a(11)=-0.12407070105941e8;
    a(12)=0.40333947204823e8;
    a(13)=0.132298488705079e9;
    a(14)=-0.37617673800749e9;    
    a(15)=-0.95250413278553e9;
    a(16)=0.24655585743928e10;
    a(17)=0.47848257694561e10;
    a(18)=-0.11582132110109e11;
    a(19)=-0.17022518297748e11;
    a(20)=0.39469335034300e11;
    a(21)=0.43141949844175e11;
    a(22)=-0.97616955325590e11;
    a(23)=-0.77417530686085e11;
    a(24)=0.17314133615815e12;
    a(25)=0.96118849114885e11;
    a(26)=-0.21425463041524e12;
    a(27)=-0.78513081753454e11;
    a(28)=0.17539493131261e12;
    a(29)=0.37939637010974e11;
    a(30)=-0.85271868689619e11;
    a(31)=-0.82123523177698e10;
    a(32)=0.18626451758590e11;
    
    %% Outer Region
    Uinf=0;
    C6=0.1892046304e8;
    C8=0.5700273275e9;
    C10=0.1866135374e11;
    Aex=-0.97014411e4;
    Gamma=5.19500;
    Beta=2.13539;
    
else
    %% Triplet potential
    Rinner=4.750;
    Router=12;
    Ns=6;

    %% Inner region
    A=-0.672898984e3;
    B=0.7735201466e7;

    %% Intermediate region
    b=-0.3;
    Rm=5.73392370;
    a(1)=-255.016075;
    a(2)=-0.83437034991917;
    a(3)=0.20960239701879e4;
    a(4)=-0.17090691582228e4;
    a(5)=-0.17873986188680e4;
    a(6)=0.29450770829461e4;
    a(7)=-0.20200111692363e5;
    a(8)=-0.35699427038012e5;
    a(9)=0.59869069169566e6;
    a(10)=-0.71054314902491e6;
    a(11)=-0.61711835715388e7;
    a(12)=0.19365507918230e8;
    a(13)=0.67930591036665e7;
    a(14)=-0.12020061749490e9;
    a(15)=0.21603960091887e9;
    a(16)=-0.63531970658436e8;
    a(17)=-0.52391212911571e9;
    a(18)=0.15913304556368e10;
    a(19)=-0.24792546801660e10;
    a(20)=0.20326032002627e10;
    a(21)=-0.68044505933607e9;
   
    %% Outer Region
    Uinf=0;
    C6=0.1892046304e8;
    C8=0.5700273275e9;
    C10=0.1866135374e11;
    Aex=0.97014411e4;
    Gamma=5.195;
    Beta=2.13539;
end;

Uinner=A+B./r.^Ns;
x=(r-Rm)./(r+b.*Rm);
Nterms=numel(a);
Uir=zeros(size(r));
for nn=1:Nterms,
    Uir=Uir+a(nn).*x.^(nn-1);
end;
rtmp=r(:);
rtmp=rtmp(rtmp>Router);
[f6,f8,f10]=KRetardation(rtmp);
f6=reshape([zeros(numel(r)-numel(rtmp),1);f6],size(r));
f8=reshape([zeros(numel(r)-numel(rtmp),1);f8],size(r));
f10=reshape([zeros(numel(r)-numel(rtmp),1);f10],size(r));
% f6=1;f8=1;f10=1;
Uouter=Uinf-f6.*C6./r.^6-f8.*C8./r.^8-f10.*C10./r.^10+Aex.*r.^Gamma.*exp(-Beta.*r);
U=Uinner.*(r<Rinner) + Uir.*((r>=Rinner) & (r<=Router)) + Uouter.*(r>Router);


end

